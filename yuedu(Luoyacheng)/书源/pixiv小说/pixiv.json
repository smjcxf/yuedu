[{
  "bookSourceGroup": "ğŸ™ˆ,pixiv",
  "bookSourceName": "ğŸŒˆpixivå°è¯´",
  "bookSourceType": 0,
  "bookSourceUrl": "https://pixivå°è¯´.luoyacheng.ip-ddns.com",
  "bookUrlPattern": "http://localhost/|https://www.pixiv.net/novel/series/\\d{3,}",
  "concurrentRate": "3/2000",
  "customOrder": 47,
  "enabled": true,
  "enabledCookieJar": false,
  "enabledExplore": true,
  "exploreUrl": "@js:\nlet banben=\"1.1.9\";\nvar obj = {\n\tåŠ¨æ€: {\n\t\t\"url\": `{{\n\t\t\tif (page == 1) {\n\t\t\turl = 'https://app-api.pixiv.net/v1/novel/follow?restrict=public';\n\t\t\t} else {url = source.get('nurl');}\n\t\t\turl=gethd(url);\n\t\t\t}}`},\n\tæ¨è: {\n\t\t\"url\": `{{\n\t\t\tif (page == 1) {\n\t\t\turl = 'https://app-api.pixiv.net/v1/novel/recommended?include_privacy_policy=true&filter=for_android&include_ranking_novels=true';\n\t\t\t} else {url = source.get('nurl');}\n\t\t\turl=gethd(url);\n\t\t\t}}`},\n\tæ”¶è—: {\n\t\t\"url\": `{{\n\t\t\tif (page == 1) {\n\t\t\t\tlet id = source.getLoginInfoMap().get('id');\n\t\t\t\turl = 'https://app-api.pixiv.net/v1/user/bookmarks/novel?user_id='+id+'&restrict=public';\n\t\t\t} else {url = source.get('nurl');}\n\t\t\turl=gethd(url);\n\t\t\t}}`,\n\t\t\"wb\": 1},\n\tè¿½æ›´: {\n\t\t\"url\": `{{\n\t\t\tif (page == 1) {\n\t\t\t\turl = 'https://app-api.pixiv.net/v1/watchlist/novel';\n\t\t\t} else {url = source.get('nurl');}\n\t\t\turl=gethd(url);\n\t\t\t}}`},\n\t'â…¹â…·': {\n\t\t\"url\": `{{\n\t\t\tif (page == 1) {\n\t\t\t\turl = 'https://app-api.pixiv.net/v1/novel/ranking?filter=for_android&mode=day_r18';\n\t\t\t} else {url = source.get('nurl');}\n\t\t\turl=gethd(url);\n\t\t\t}}`,\n\t\t\twb:1,\n\t\t\tfb:0.2},\n\t'â…¹â…·_AI': {\n\t\t\"url\": `{{\n\t\t\tif (page == 1) {\n\t\t\t\turl = 'https://app-api.pixiv.net/v1/novel/ranking?filter=for_android&mode=week_ai_r18';\n\t\t\t} else {url = source.get('nurl');}\n\t\t\turl=gethd(url);\n\t\t\t}}`,\n\t\t\tfb:0.2},\n\t'â…¹â…·_WK': {\n\t\t\"url\": `{{\n\t\t\tif (page == 1) {\n\t\t\t\turl = 'https://app-api.pixiv.net/v1/novel/ranking?filter=for_android&mode=week_r18';\n\t\t\t} else {url = source.get('nurl');}\n\t\t\turl=gethd(url);\n\t\t\t}}`,\n\t\t\tfb:0.2}\n\t}\n\n\nvar sort = [];\npush = (title, url, fg, wrap, fb) => sort.push({\n    \"title\": title,\n    \"url\": url,\n    \"style\": {\n      layout_flexGrow: fg || 1,\n      layout_flexBasisPercent: fb||-1,\n      layout_wrapBefore: wrap ? true : false\n     }\n  });\n\nfor (x in obj) {\npush(x, obj[x].url, obj[x].fg, obj[x].wb, obj[x].fb);\n}\nJSON.stringify(sort);",
  "header": "@js:\n(()=>{\n\tlet headers = gethd();\n\treturn JSON.stringify(headers);\n})();",
  "jsLib": "//å‚è€ƒè‡ªå¼€æºé¡¹ç›®ï¼špixez-flutterğŸ™\nsleep = Packages.java.lang.Thread.sleep;\nua = 'PixivAndroidApp/5.0.166 (Android 14; RMX3366)';\nappv = '5.0.166';\na_l = 'zh-CN';\n\nbiaoq = new RegExp('^(?:NTR|NTL|ä¿®ä»™|å¥‡å¹»|åå®«|çº¯çˆ±|éšå¥¸|ä¹±ä¼¦|ä¹±äº¤|æ¯å¥³.?|æ¯å­|çˆ¶å¥³|å¹¼å¥³|å§å¼Ÿ|äººå¦»|æ­£å¤ª|è¶³äº¤|å£äº¤|è‚›äº¤|ä¸è¢œ|å‚¬çœ |ç³»ç»Ÿ|åŸåˆ›|ç»­å†™|è½¯é¥­æµ|ä¿®ç½—åœº|è§„åˆ™æ€ªè°ˆ|å¥³æ€§è§†è§’|æ€§å¼€æ”¾ä¸–ç•Œ|å¥¸å°¸|å†°æ‹|.?é‡å£)$','i');\n\nfunction timemd5(time) {\n\tconst {java, source} = this;\nlet salt = '28c1fdd170a5204386cb1313c7077b34f83e4aaf4aa829ce78c231e05b0bae2c';\nlet hash = java.md5Encode(time + salt);\n\treturn hash;\n}\n\n\nfunction gethd(url='',ck='') {\n\tconst {java, source} = this;\nlet time = java.timeFormatUTC(Date.now(),\"yyyy-MM-dd'T'HH:mm:ss'+00:00'\",8*60*60*1000);\nlet hash = this.timemd5(time);\nlet atk = source.getLoginHeader()||'';\nif(atk) atk = String('Bearer '+atk);\nlet headers = {\n    'x-client-time': time,\n    \t'User-Agent': ua,\n    \t'accept-language': a_l,\n    \t'authorization': atk,\n    \t'app-os': 'Android',\n    \t'app-os-version': 'Android 14',\n    \t'app-version': appv,\n    'x-client-hash': hash,\n    'cookie': ''\n    \t }\nck!='' && (headers['cookie']=ck);\nurl=url.replace(\"app-api.pixiv.net\",\"210.140.139.155\");\nurl && (headers['host']='app-api.pixiv.net');\nif (url=='') return headers;\nelse if (url.startsWith('data')) return url;\nelse {\n\tdelete headers['x-client-time'];\n\tdelete headers['x-client-hash'];\n\treturn url + ',' + JSON.stringify({'headers':headers});}\n};\n\n\nfunction leng(str) {\n\tlet length = 0;\n\tconst fuhao = ',.?!:;()[]\"';\n\tconst fuhao2 = 'ğŸ“˜';\n\tfor (let char of str) {\n\t\tif (fuhao.includes(char) ) length += 0.5;\n\t\telse if (fuhao2.includes(char) ) length += 2;\n\t\telse length += 1;\n\t\t}\n\t\treturn length;\n}\n\nfunction gethdi(url='') {\turl=url.replace(\"i.pximg.net\",\"210.140.139.133\");\nlet imgoptions = {\n  headers: {\n    'User-Agent': 'PixivIOSApp/5.8.0',\n    'accept-encoding': 'gzip, br',\n    'referer': 'https://app-api.pixiv.net/',\n    'host': 'i.pximg.net'\n    }\n  };\n  return url+','+JSON.stringify(imgoptions);\n }\n \nfunction copy(txt) {\n\tlet htm = `data:text/html;charset=utf-8,<html>\n<head>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<style>\nbody {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\talign-items: center;\n\theight: 60vh;}\n</style>\n</head>\n<body>\n<textarea id=\"copyt\" rows=\"3\">${txt}</textarea>\n<br>\n<button id=\"btn1\" onclick=\"copy()\">å¤åˆ¶</button>\n<script>\ndocument.addEventListener(\"DOMContentLoaded\", function () {\nconst textarea = document.getElementById(\"copyt\");\ntextarea.style.height = \"auto\";\ntextarea.style.height = textarea.scrollHeight + \"px\";});\nfunction copy() {\nconst cpt = document.getElementById(\"copyt\");\ncpt.select();\ndocument.execCommand(\"copy\");}\n</script>\n</body></html>`;\nthis.java.startBrowser(htm,'å¤åˆ¶');\n\t}\n\n\nfunction lookc(lyc) {\nconst [title,uid,unm,uim,tags,caption,cdate,xh,sc,gk,sTitle,id,ugz] = lyc;\n\tlet htm = `<html>\n<head>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<style>\ntable {\n\twidth: 100%;\n\ttable-layout: fixed;\n\ttext-align: center;\n\tmargin: 0 auto;\n\tword-break: break-all;\n\t}\ntd img {\n\twidth: 100%;\n\theight: 100%;\n\tobject-fit: contain;\n\t}\n.cap {\n\t text-align: left;\n\t text-indent: 2em;\n\t}\na {text-decoration: none;}\np {margin: 0.2em auto;}\n</style>\n</head>\n<body>\n<table border=\"1\" cellspacing=\"0\">\n<tr>\n<th colspan=\"6\">æ ‡é¢˜ï¼š<a href=\"https://www.pixiv.net/novel/show.php?id=${id}\">${title}</a></th>\n</tr>\n<tr>\n<td colspan=\"4\">\nä½œè€…ï¼š<a href=\"https://www.pixiv.net/users/${uid}\">${unm}</a>\n${ugz=='true' ? '<span style=\"font-size: 0.7em;\"> (å·²å…³æ³¨)</span>' : ''}\n</td>\n<td colspan=\"2\"><img src=\"${uim}\"></td>\n</tr>\n${sTitle!='' ? ('<tr><td colspan=\"6\">å°è¯´ï¼šã€Š'+sTitle+'ã€‹'+'</td></tr>') : ''}\n<tr>\n<td>å–œæ¬¢</td>\n<td>${xh}</td>\n<td>æ”¶è—</td>\n<td>${sc}</td>\n<td>è§‚çœ‹</td>\n<td>${gk}</td>\n</tr>\n<tr>\n<td>æ—¶é—´</td>\n<td colspan=\"5\">${cdate}</td>\n</tr>\n<td>æ ‡ç­¾</td>\n<td colspan=\"5\">${tags}</td>\n</tr>\n${caption!='' ? ('<tr><td>ç®€ä»‹</td><td class=\"cap\" colspan=\"5\">'+caption+'</td></tr>') : ''}\n</table>\n<br>\n<script>\n\n</script>\n</body></html>`;\nlet java=this.java;\njava.startBrowser(`data:text/html;base64,${java.base64Encode(htm)}`,'ä¿¡æ¯');\n}\n\nfunction gengxin(){\nconst {java, source} = this;\n\tlet url0='https://gitee.com/lyc486/yuedu2/commits/main/ä¹¦æº/pixivå°è¯´/pixiv.json?browser_history=0&page=1&per=3';\n\tlet rr0=java.get(url0,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body();\n\tlet \tgxlrr = com.jayway.jsonpath.JsonPath.read(rr0, '$.list[0:3].title');\n\tlet [gxlr, gxlr2, gxlr3] = gxlrr;\n\tlet banben =   String(source.exploreUrl).match(/let banben=\"([\\d\\.]+)\"/)[1];\n\tgxlr=String(gxlr).split(/^([^\\-]+)-/);\n\tgxlr[0]=='' ? '' : gxlr=['','0',gxlr[0]];\n\tlet gxts;\n\tif (gxlr[1]>banben){gxts=['æ›´æ–°','0,140,186'];}\n\telse {gxts= ['å¯¼å…¥','76,175,80'];};\n\tlet htm = `<html>\n<head>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<style>\ntable {\n\ttext-align: center;\n\tmargin: 0 auto;\n\t}\n.ann {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\theight: 50vh;\n\t}\nbutton {\n\tbackground-color: rgb(${gxts[1]});\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 4px;\n\theight: 6vh;\n\twidth: 30vw;\n\toverflow: hidden;\n\t}\nbutton span {\n  cursor: pointer;\n  display: inline-block;\n  position: relative;\n  transition: 0.4s;\n}\nbutton span:after {\n  content: '>';\n  position: absolute;\n  opacity: 0;\n  top: 0;\n  right: 30px;\n  transition: 0.2s;\n}\nbutton:active span {\n  padding-right: 20px;\n}\nbutton:active span:after {\n  opacity: 1;\n  right: -40px;\n}\n</style>\n</head>\n<body>\n<table border=\"1\" cellspacing=\"0\">\n<th colspan=\"2\">æœ€æ–°æ—¥å¿—ï¼š${gxlr[2]}</th>\n<tr>\n<td>ä»“åº“ç‰ˆæœ¬ï¼š${gxlr[1]}</td>\n<td>æœ¬åœ°ç‰ˆæœ¬ï¼š${banben}</td>\n</tr>\n<tr>\n<td colspan=\"2\" style=\"text-align: left;\">å¾€æœŸæ—¥å¿—ï¼š${gxlr2}<br>ã€€ã€€ã€€ã€€ã€€${gxlr3}</td>\n</tr>\n</table>\n<div class=\"ann\">\n<a href=\"legado://import/importonline?src=https://github.com/Luoyacheng/yuedu/raw/main/ä¹¦æº/pixivå°è¯´/pixiv.json\">\n<button><span>${gxts[0]}</span></button>\n</a>\n</div>\n<a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/Luoyacheng/yuedu@main/ä¹¦æº/pixivå°è¯´/pixiv.json\" style=\"font-size: 10px;\">å¤‡ç”¨é“¾æ¥</a>\n</body>\n</html>`;\nif(typeof this.book=='undefined'||gxts[0]=='æ›´æ–°') java.startBrowser(`data:text/html;base64,${java.base64Encode(htm)}`,'pxæ›´æ–°');\r\n}\nfunction fankui(){\tthis.java.startBrowser('https://github.com/Luoyacheng/yuedu/discussions/categories/b-pixiv?discussions_q=','pxåé¦ˆ');\n}",
  "lastUpdateTime": 1752907612344,
  "loginCheckJs": "//java.toast('ç™»å½•æ£€æŸ¥ï¼š'+result);\n\nif (result.code() == 400) {\n\tsource.login();\n\tsleep(500);\n\tlet url = gethd(result.url());\n\tresult = java.connect(url);\n\t}\nresult",
  "loginUi": "[\n    {\n        name: \"token\",\n        type: \"text\"\n    },\n    {\n        name: \"tokenè¯´æ˜\",\n        type: \"button\",\n        action: \"java.longToast(`\ntokenè¯´æ˜ï¼š\nå¡«å†™è¯¥å€¼åç‚¹å‡»å³ä¸Šè§’âˆšè¿›è¡Œç™»å½•\nå¯ä»¥é€šè¿‡è·å–tokenæŒ‰é’®å¾—åˆ°(ä¸éœ€è¦è·³è½¬app)\né˜…è¯»æ­£å¼ç‰ˆæ— æ³•æ”¯æŒè·å–tokenåŠŸèƒ½`);\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n    {\n        name: \"è·å–token\",\n        type: \"button\",\n        action: \"Login()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n    {\n        name: \"id\",\n        type: \"text\"\n    },\n    {\n        name: \"idè¯´æ˜\",\n        type: \"button\",\n        action: \"java.longToast(`\nidè¯´æ˜ï¼š\nç™»å½•æ—¶è¯¥å€¼ä¸ºç©ºä¼šè‡ªåŠ¨å¡«å†™è¯¥å€¼ï¼Œè¿™æ˜¯ç™»å½•è´¦å·çš„IDï¼ˆå¯æ‰‹åŠ¨æ›´æ”¹ï¼‰ã€‚\nå‘ç°é¡µçš„æ”¶è—åˆ†ç±»åŠ è½½çš„è¯¥IDçš„æ”¶è—`);\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n    {\n        name: \"æœç´¢è¯´æ˜\",\n        type: \"button\",\n        action: \"java.longToast(`\næœç´¢è¯´æ˜ï¼š\né»˜è®¤ä½¿ç”¨å…³é”®è¯æœç´¢\nè¾“å…¥å°è¯´idå·æ˜¾ç¤ºå¯¹åº”çš„å°è¯´\nè¾“å…¥â€œæ­£æ–‡@è®¸æ–Œâ€æœç´¢æ­£æ–‡å«è®¸æ–Œçš„å°è¯´\nè¾“å…¥â€œä½œè€…@69559022â€æœç´¢æŒ‡å®šidä½œè€…çš„ä¹¦`);\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n    {\n        name: \"ä¹¦å\",\n        type: \"text\"\n    },\n     {\n        name: \"â†‘è¿½æ›´è¯¥ä¹¦\",\n        type: \"button\",\n        action: \"scz(3)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n     {\n        name: \"å¤åˆ¶id\",\n        type: \"button\",\n        action: \"fuzhi(2)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n     {\n        name: \"å–æ¶ˆè¿½æ›´\",\n        type: \"button\",\n        action: \"scz(30)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        name: \"ç« èŠ‚\",\n        type: \"text\"\n    },\n    {\n        name: \"â†‘æ”¶è—è¯¥ç« \",\n        type: \"button\",\n        action: \"scz(1)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n     {\n        name: \"è¯¦æƒ…\",\n        type: \"button\",\n        action: \"caption()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n     {\n        name: \"å–æ¶ˆæ”¶è—\",\n        type: \"button\",\n        action: \"scz(10)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        name: \"ä½œè€…\",\n        type: \"text\"\n    },\n    {\n        name: \"â†‘å…³æ³¨ä½œè€…\",\n        type: \"button\",\n        action: \"scz(2)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n     {\n        name: \"å¤åˆ¶id\",\n        type: \"button\",\n        action: \"fuzhi(1)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n     {\n        name: \"å–æ¶ˆå…³æ³¨\",\n        type: \"button\",\n        action: \"scz(20)\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    \t{\n        name: \"ğŸ“˜ä¹¦åæ ‡è¯†\",\n        type: \"button\",\n        action: \"gongcun()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    \t{\n        name: \"åé¦ˆ\",\n        type: \"button\",\n        action: \"fankui()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n    \t{\n        name: \"ç‰ˆæœ¬æ›´æ–°\",\n        type: \"button\",\n        action: \"gengxin()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    \t{\n        name: \"ğŸ«§è¡¥å……åºå·\",\n        type: \"button\",\n        action: \"xvhao()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        name: \"å ä½\",\n        type: \"button\",\n        action: \"java.longToast(`è¿™é‡Œæ²¡æœ‰ä¸œè¥¿`);\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.2\n        }\n    },\n    \t{\n        name: \"ä¹¦æºä»‹ç»\",\n        type: \"button\",\n        action: \"java.startBrowser('https://luoyacheng.cloudns.ch/#Pç«™','ä»‹ç»');\",\n        \"style\": {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    \t{\n        name: \"ï¼ƒç®€ä»‹æ ‡ç­¾\",\n        type: \"button\",\n        action: \"biaoqian()\",\n        \"style\": {\n            \"layout_flexGrow\": 0,\n            \"layout_flexBasisPercent\": -1\n        }\n    },\n    {\n        name: \"å±è”½æ ‡ç­¾\",\n        type: \"text\"\n    }\n]",
  "loginUrl": "function gongcun() {\nlet gc = source.get('gc');\nif(gc!=1) {source.put('gc',1);java.toast('ğŸŸ¢å·²å¼€å¯\\nä¹¦åå¼€å¤´ä¼šæœ‰ğŸ“˜ç¬¦å·');}\nelse {source.put('gc',0);java.toast('âš«å·²å…³é—­\\nä¸ä¼šæ·»åŠ ğŸ“˜');}\n\t}\nfunction xvhao() {\nlet xh = source.get('xh');\nif(xh!=1) {source.put('xh',1);java.toast('ğŸŸ¢å·²å¼€å¯\\nä¼šè‡ªåŠ¨è¡¥å……ç« èŠ‚ååºå·');}\nelse {source.put('xh',0);java.toast('âš«å·²å…³é—­\\nä¸ä¼šè¡¥å……åºå·');}\n\t}\nfunction biaoqian() {\nlet bq = source.get('bq');\nif(bq!=1) {source.put('bq',1);java.toast('ğŸŸ¢å·²å¼€å¯\\nä¼šåœ¨ç®€ä»‹æ˜¾ç¤ºä½œå“æ ‡ç­¾');}\nelse {source.put('bq',0);java.toast('âš«å·²å…³é—­\\nä¸ä¼šæ˜¾ç¤ºç®€ä»‹æ ‡ç­¾');}\n\t}\n\nfunction login() {\nlet time = java.timeFormatUTC(Date.now(),\"yyyy-MM-dd'T'HH:mm:ss'+00:00'\",8*60*60*1000);\nlet hash = timemd5(time);\n\tlet headers = {\n    'User-Agent': 'PixivAndroidApp/5.0.155 (Android 6.0; Pixel C)',\n    'content-type': 'application/x-www-form-urlencoded',\n    'x-client-hash': hash,\n    'accept-language': a_l,\n    'app-version': appv,\n    'app-os-version': 'Android 6.0',\n    'x-client-time': time,\n    'app-os': 'Android'\n  };    \n  let url = 'https://oauth.secure.pixiv.net/auth/token';\n  headers['host']='oauth.secure.pixiv.net';\n  url =url.replace(\"oauth.secure.pixiv.net\",\"210.140.139.155\");\n  let Info = source.getLoginInfoMap();\n  \n  try {\n  let tk = Info.token;\n  let body = `client_id=MOBrBDS8blbauoSck0ZfDbtuzpyT&client_secret=lsACyCD94FhDUtGTXi3QzcFE2uU1hqtDaKeqrdwj&grant_type=refresh_token&refresh_token=${tk}&include_policy=true`;\n\tlet rr = java.post(url,body,headers).body();\n\tlet atk = rr.match(/\"access_token\"[:\\s\"]+([^\"]+)/)[1];\n\tsource.putLoginHeader(atk);\n\tif (Info.id=='') {\n\t\tInfo.id = com.jayway.jsonpath.JsonPath.read(rr, \"$.user.id\");}\n\tsource.putLoginInfo(JSON.stringify(Info));\n\t//java.toast('\\nğŸ˜†ç™»å½•æˆåŠŸ');\n\t} catch(err) {\n\t\tjava.toast('\\nğŸ’”ç™»å½•å¤±è´¥');\n\t\tjava.log('pxç™»å½•å¤±è´¥ï¼š'+err);\n  \tsleep(600);}\n}\n\nfunction scz(x) {\n\tlet headers = gethd();\n\t//let url = 'https://app-api.pixiv.net/';\n\tlet url = \"https://210.140.139.155/\";\n\tlet body,nm,tt,ttt;\n\tif (x==1) {\n\t url += 'v2/novel/bookmark/add';\n\t \tlet id = cache.get('pxid');\n\t \tif (id=='') ttt='è¯·åˆ·æ–°ç« èŠ‚';\n\t \tbody = 'novel_id='+id+'&restrict=public';\n\t \tnm = source.getLoginInfoMap().get('ç« èŠ‚');\n\t \ttt='æ”¶è—';\n\t } else if(x==2) {\n\t \turl += 'v1/user/follow/add';\n\t \tlet uid = cache.get('pxuid');\n\t \tif (uid=='') ttt='è¯·åˆ·æ–°ç« èŠ‚æˆ–è¯¦æƒ…é¡µ';\n\t \tbody = 'user_id='+uid+'&restrict=public';\n\t \tnm = source.getLoginInfoMap().get('ä½œè€…');\n\t \ttt='å…³æ³¨';\n\t \t} else if(x==10) {\n\t \turl += 'v1/novel/bookmark/delete';\n\t \tlet id = String(cache.get('pxid'));\n\t \tbody = id ? 'novel_id='+id : '';\n\t \tnm = source.getLoginInfoMap().get('ç« èŠ‚');\n\t \ttt='å–æ¶ˆæ”¶è—ğŸ˜…';\n\t \t} else if(x==20) {\n\t \turl += 'v1/user/follow/delete';\n\t \tlet uid = String(cache.get('pxuid'));\n\t \tbody = uid ? 'user_id='+uid : '';\n\t \tnm = source.getLoginInfoMap().get('ä½œè€…');\n\t \ttt='å–æ¶ˆå…³æ³¨ğŸ˜…';\n\t \t} else if(x==3) {\n\t \turl += 'v1/watchlist/novel/add';\n\t \tlet sid = cache.get('pxsid');\n\t \tif (sid=='') ttt='è¯·åˆ·æ–°è¯¦æƒ…é¡µ';\n\t \tbody = 'series_id='+sid;\n\t \tnm = source.getLoginInfoMap().get('ä¹¦å');\n\t \ttt='è¿½æ›´';\n\t \t} else if(x==30) {\n\t \turl += 'v1/watchlist/novel/delete';\n\t \tlet sid = String(cache.get('pxsid'));\n\t \tbody = sid ? 'series_id='+sid : '';\n\t \tnm = source.getLoginInfoMap().get('ä¹¦å');\n\t \ttt='å–æ¶ˆè¿½æ›´ğŸ˜…';\n\t \t}\n\n\ttry {\n\t\tif (ttt) {java.longToast(ttt);throw 'tç©º';}\n\t\tif (!body) throw 'bç©º';\n\t\theaders['host']='app-api.pixiv.net';\n\t\tlet jg = java.post(url,body,headers).statusCode();\n\t\tif (jg!=200) throw tt+'å“åº”ç å¼‚å¸¸';\n\t\telse java.longToast(`\\nå·²${tt}ï¼š\\n${nm}`);\n\t\t} catch(e) {\n\t\t\tif (!ttt) java.toast(`\\n${tt}å¤±è´¥`);\n\t\t\tjava.log(e);}\n\t}\n\nfunction reck() {\nsource.removeLoginHeader();\ncookie.removeCookie('https://accounts.pixiv.net');\ncookie.removeCookie('https://accounts.google.com');\ncookie.removeCookie('https://api.weibo.com');\n\t}\n\nfunction Login() {\nlet rkey = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~';\nlet cv='';\nfor (let i = 0; i < 128; i++) {\n\tlet ra = Math.floor(Math.random()*rkey.length);\n\tcv+=rkey.charAt(ra);}\n\nlet aly = new JavaImporter(\nPackages.cn.hutool.crypto.digest.Digester,\nPackages.cn.hutool.core.codec.Base64,\nPackages.cn.hutool.crypto.digest.DigestAlgorithm);\nwith (aly) {\n\t//è½¬ASCIIæ•°ç»„\n\tlet asBs =  Packages.java.lang.String(cv).getBytes(\"US-ASCII\");\n\t//åˆ›å»ºSHA256å¹¶è®¡ç®—\n\tlet digester = new Digester(DigestAlgorithm.SHA256);\n\tlet hashBs = digester.digest(asBs);\n\t//Base64URLç¼–ç å¹¶ç§»é™¤å¡«å……\n\tvar codeChallenge  = Base64.encodeUrlSafe(hashBs);\n}\n\nlet urllg =`https://app-api.pixiv.net/web/v1/login?code_challenge=${codeChallenge}&code_challenge_method=S256&client=pixiv-android`;\nreck();\n//é˜²æ­¢é‡å®šå‘é”™è¯¯ï¼Œæ¸…ä¹¦æºcookieã€‚ä¹Ÿéœ€è¦æ‰‹åŠ¨æ¸…å†…ç½®æµè§ˆå™¨cookie\n\nlet wbua=java.getWebViewUA().replaceAll(\"; wv| Version\\/4.0\",'')+'';\nif (/HUA\\s*WEI/i.test(wbua))\nwbua=\"Mozilla/5.0 (Linux; Android 14; RMX3366 Build/UKQ1.230924.001) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.7049.100 Mobile Safari/537.36\";\n\nlet bb=java.startBrowserAwait(urllg+`,{\n\"headers\":{\n\t\"User-Agent\": \"${wbua}\"\n\t}}`,'ç™»å½•',false).body();\nlet code;\nif (bb.includes('<title>Online com')) {\nsleep(600);\njava.toast('ç¨ç­‰');\nlet over = java.webViewGetOverrideUrl(bb,'https://app-api.pixiv.net/','','pixiv:.*');\ncode = over.match(/code=([^&]+)/);\n}\nreck();\n\nlet token;\nif (code) {\nlet tkurl = 'https://oauth.secure.pixiv.net/auth/token';\nlet headers = gethd();\nlet body = `code_verifier=${cv}&code=${code[1]}&grant_type=authorization_code&redirect_uri=https://app-api.pixiv.net/web/v1/users/auth/pixiv/callback&client_id=MOBrBDS8blbauoSck0ZfDbtuzpyT&client_secret=lsACyCD94FhDUtGTXi3QzcFE2uU1hqtDaKeqrdwj&include_policy=true`;\nlet tkr = java.post(tkurl,body,headers);\n//java.log(tkr.body());\ntoken = tkr.body().match(/refresh_token\":\"([^\"]+)/);\n}\n\nif (token) {\nlet htm = `data:text/html;charset=utf-8,<html>\n<head>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><style>\nh2 {\n\ttext-align: center;\n\tline-height: 6;}\ntextarea {\n\tfont-size: 12px;\n\twidth: 96%;\n\tmargin: 10px 2%;\n\tpadding: 6px;}\n.ann {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\theight: 50vh;}\nbutton {\n\tbackground-color: rgb(76,175,80);\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 4px;\n\theight: 6vh;\n\twidth: 30vw;\n\toverflow: hidden;\n\ttransition: font-size 0.3s;\n\tfont-size: 16px;}\n.an-s {\n\tfont-size: 12px;}\n.alert-overlay {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground: rgba(0, 0, 0, 0.6);\n\tdisplay: none;\n\tjustify-content: center;\n\talign-items: center;\n\tz-index: 9999;}\n/* å¯¹è¯æ¡†ä¸»ä½“ */\n.alert-box {\n\tbackground: rgb(232,234,246);\n\tpadding: 10px;\n\tborder-radius: 12px;\n\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n\tmin-width: 100px;\n\ttext-align: center;}\n</style></head>\n<body>\n<div class=\"alert-overlay\" id=\"alertO\">\n <div class=\"alert-box\">\n  <p>å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼š</p>\n  <p id=\"alertM\" style=\"font-size: 12px;\"></p>\n </div>\n</div>\n<h2>Tokenè·å–æˆåŠŸğŸ¥³</h2>\n<textarea readonly id=\"copyt\" rows=\"3\">${token[1]}</textarea>\n<p style=\"font-size: 12px;\">è¯·å¤åˆ¶ç²˜è´´åˆ°ç™»å½•ç•Œé¢çš„tokenæ¡†ï¼Œç„¶åç‚¹å‡»âˆšè¿›è¡Œç™»å½•</p>\n<div class=\"ann\">\n<button id=\"btn1\" onclick=\"copy()\">å¤åˆ¶</button>\n</div>\n<script>\nfunction showAlert(txt, time) {\nconst overlay = document.getElementById('alertO');\nconst message = document.getElementById('alertM');\nmessage.textContent = txt;\noverlay.style.display = 'flex';\nif (time > 0) {\n\tsetTimeout(() => {\n\t\toverlay.style.display = 'none';\n\t\t}, time);\n\t}\n}\nfunction copy() {\nconst btn = document.getElementById('btn1');\nbtn.classList.add('an-s');\nconst cpt = document.getElementById(\"copyt\");\ncpt.select();\ntry {\n    const cpy = document.execCommand(\"copy\");\n    if (cpy.length<9) throw 'å¼‚å¸¸';\n    showAlert(cpt.value, 1000);\n  } catch (e) {alert(\"å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶\");}\nsetTimeout(() => {\n\tbtn.classList.remove('an-s');\n\t}, 450);\n}\n</script>\n</body></html>`;\n\njava.startBrowser(htm,'è·å–token');\njava.log(token[1]); //ç•™ä¸€ä»½åˆ°æ—¥å¿—\t\n\t} else {sleep(700);java.toast('è·å–å¤±è´¥ğŸ˜­');}\n}\n\nfunction fuzhi(x) {\n\tif (x==1) {\n\tlet uid = cache.get('pxuid');\n\tcopy(uid);}\n\tif (x==2) {\n\tlet sid = cache.get('pxsid');\n\tcopy(sid);}\n\t}\n\nfunction caption() {\n\tlet lyc=cache.getFromMemory('pxcjj');\n\tif (lyc) lookc(lyc);\n\telse java.longToast('è¯·åˆ·æ–°æ­£æ–‡');\n\t}",
  "respondTime": 229699,
  "ruleBookInfo": {
    "author": "$.novel_series_detail.user.name\n<js>\nlet uid = java.get('uid');\nlet auth = result || String(book.author).replace(/[\\u200b]+/,'');\nif (uid == '') {uid = java.getString('$.novel_series_detail.user.id');}\nlet Info=source.getLoginInfoMap();\nInfo['ä½œè€…'] = auth;\ncache.put('pxuid',uid);\nsource.putLoginInfo(JSON.stringify(Info));\n'\\u200b' + auth\n</js>",
    "canReName": "1",
    "init": "<js>\nvar sid = java.get('sid');\nlet i = String(book.bookUrl).includes('https:/');\nif (i) { sid = String(book.bookUrl).match(/\\d{3,}$/);}\n\ncache.deleteMemory('pxcjj'); //ä»…é€šè¿‡æ­£æ–‡æ‰“å¼€è¯¦æƒ…ï¼Œé˜²é”™\nif (sid == 'ğŸ‡¨ğŸ‡³') {\n\tlet Info=source.getLoginInfoMap();\n\tlet bkn = String(book.name);\n\tlet id = java.hexDecodeToString(result).match(/\\d+$/)[0];\n\tInfo['ä¹¦å'] = '';\n\tcache.put('pxsid','');\n\tInfo['ç« èŠ‚'] = bkn;\n\tcache.put('pxid',id);\n\tsource.putLoginInfo(JSON.stringify(Info));\n\tlet length = leng(bkn);\t\nbook.intro = (source.get('bq')==1?String(java.get('tags')).replace(/, /g,' #').replace('[','#').replace(']','\\n\\n'):'') + (length>18?('ã€Š'+book.name+'ã€‹\\n'):'') + java.get('jianjie');\n\trr='1';\n\n} else {\nlet url = 'https://app-api.pixiv.net/v2/novel/series?series_id=' + sid;\n//ä¿®æ­£bookurl\nbook.bookUrl = `data:;base64,${java.base64Encode(url)},{\"type\":\"px\"}`;\n\ntry {\n\njg = java.connect(gethd(url));\nrr = jg.body();\nif (jg.code() == 400) {\n\tsource.login();\n\tPackages.java.lang.Thread.sleep(500);\n\trr = java.ajax(gethd(url));\n\t}\n\n} catch(err) {\n\trr={};\n\tjava.toast('è¯¦æƒ…é¡µé“¾æ¥åŠ è½½å¤±è´¥'+sid);\n\t}\n\n//è®¾ç½®è§£æç»“æœ\njava.setContent(rr);\n\n\n//æ›´æ–°æ›´æ–°æ—¶é—´\ntry {\nlet tm = java.getString('$.novel_series_latest_novel.create_date');\nlet d = new Date(tm);\nd = java.timeFormatUTC(d,'yy/MM/dd',8*60*60*1000);\nbook.kind = String(book.kind).replace(/\\d+\\/\\d+\\/\\d+|$/,d).replace('null','');\n} catch(err) {java.toast('è¯¦æƒ…é¡µå†…å®¹é”™è¯¯');}\n\n//è·å–ä¹¦åå¹¶å‡€åŒ–\nlet bkn = String(java.getString('$.novel_series_detail.title')).replace(/^ã€Š(.+)ã€‹$/,'$1');\nbook.name = bkn.replace(/[(ï¼ˆ].{0,9}((?:ä»™ä¾ |çº¯çˆ±|åå®«|èè‰).?){3,}.{0,9}[)ï¼‰](?=\\s*[ä¸€-ê€€])/,'');\n\n//java.log('â”Œè·å–ä¹¦å\\n[99:99.999] â””'+book.name);\n\n//è·å–ä¹¦åå¤±è´¥\nif (book.name == '') {\n\t//æ•ˆæœï¼Œunicodeè½¬å­—ç¬¦\n\t// let ee = JSON.stringify(JSON.parse(rr) );\n\tlet txte = java.getString('$..user_message',rr);\n\t//å¼¹å‡ºæç¤ºï¼Œsidç›¸åº”åºåˆ—ä¸å­˜åœ¨\n\tjava.longToast('\\næœªè·å–åˆ°ä¹¦å\\n'+txte);\n\t} else {\n\t\n\t//æ”¾å…¥ä¹¦å\n\tlet Info=source.getLoginInfoMap();\n\tInfo['ä¹¦å'] = book.name;\n\tcache.put('pxsid',sid);\n\tInfo['ç« èŠ‚'] = '';\n\tcache.put('pxid','');\n\tsource.putLoginInfo(JSON.stringify(Info));\n\t\n\t//åŒåå…±å­˜\n\tif (source.get('gc') == 1) book.name='ğŸ“˜'+book.name;\n\t}\n\n//è¡¥å……å°é¢é“¾æ¥\nif (book.coverUrl == null) {\n\tlet img = java.getString('$.novel_series_latest_novel.image_urls.large');\n\tbook.coverUrl = gethdi(img);\n\t\t\n//java.log('â”Œè·å–å°é¢\\n[99:99.999] â””'+book.coverUrl);\n}\n\n//è®¡ç®—ä¹¦åé•¿åº¦\nlet length = leng(String(book.name));\n//å¤§äº18ä¸ªå…¨è§’å­—ç¬¦\nif (length > 18) length= 'ã€Š'+String(book.name).replace(/^ğŸ“˜/,'')+'ã€‹\\n';\nelse length = '';\nlet jianjie = java.getString('$.novel_series_detail.caption');\nbook.intro = (source.get('bq')==1?String(java.get('tags')).replace(/, /g,' #').replace('[','#').replace(']','\\n\\n'):'') + length + java.get('jianjie');\njava.put('jianjie',jianjie);\njava.put(\"bookr\",rr);\n}\n\nrr\n</js>",
    "lastChapter": "$.novel_series_latest_novel.title##[ã€ã€Š]?{{book.name}}[ã€‹ã€‘]?",
    "tocUrl": "@js:book.bookUrl",
    "wordCount": "$.novel_series_detail.total_character_count"
  },
  "ruleContent": {
    "content": "script.0@html\n<js>\nlet rr = result.match(/novel:\\s*({.+})/)[1];\nlet id = String(chapter.url).match(/\\d+(?=$|,)/)[0];\n\nlet bin = book.durChapterIndex;\nlet cin = chapter.index;\nlet inn = cin - bin;\nif (inn==0) {\nlet rra = result.match(/authorDetails:\\s*({.+})/)[1];\n//ä½œè€…ä¿¡æ¯\nlet uid = java.getString('$..userId',rra);\nlet unm = java.getString('$..userName',rra);\nlet uim = java.getString('$..url',rra);\nuim = uim.replace('i.pximg.net','pximg.hakurei.cc');\nlet ugz = java.getString('$..isFollowed',rra);\n//ä½œå“ä¿¡æ¯\nlet tags = java.getStringList('$..tags[*]',rr);\ntags = Array.from(tags).map(x => `ï¼ƒ${x}`).join(' ');\nlet caption = String(java.getString('$..caption',rr));\ncaption = caption ? '<p>'+caption.replace(/(?:<br \\/>)+/g, '</p><p>')+'</p>' : '';\nlet cdate = java.getString('$..cdate',rr);\nlet xh = java.getString('$..rating.like',rr);\nlet sc = java.getString('$..rating.bookmark',rr);\nlet gk = java.getString('$..rating.view',rr);\nlet title = java.getString('$.title',rr);\nlet sTitle = java.getString('$.seriesTitle',rr);\n//æ”¾å…¥ä¿¡æ¯\ncache.putMemory('pxcjj',[title,uid,unm,uim,tags,caption,cdate,xh,sc,gk,sTitle,id,ugz]);\ncache.put('pxuid',uid);\ncache.put('pxid',id);\nlet Info=source.getLoginInfoMap();\n\nlet sid = java.get('sid');\nif (sid != 'ğŸ‡¨ğŸ‡³') {\n\tInfo['ä¹¦å']=String(book.name).replace(/^ğŸ“˜/,'');\n\tcache.put('pxsid',sid);} else {\n\tInfo['ä¹¦å']='';\n\tcache.put('pxsid','');}\n\nInfo['ç« èŠ‚'] = chapter.title;\nInfo['ä½œè€…'] = book.author.replace('\\u200b','');\n//æ”¾å…¥UIç•Œé¢\nsource.putLoginInfo(JSON.stringify(Info));\n}\n\nlet urls = java.getString('$..urls',rr);\nlet tt = String(java.getString('$.text',rr));\nlet img1 = tt.match(/\\[uploadedimage\\:\\d+\\]/g)||'';\nlet img2 = tt.match(/\\[pixivimage\\:[\\d\\-]+\\]/g)||'';\nfor (x of img1) {\n\tlet id = x.match(/\\d+/)[0];\n\tlet url = java.getString('$..'+id+'.urls.original',rr);\n\tlet re = new RegExp('\\\\[uploadedimage\\\\:'+id+'\\\\]');\n\ttt = tt.replace(re,'<img src=\"'+gethdi(url)+'\"/>');\n\t}\nfor (x of img2) {\n\tlet id = x.match(/[\\d\\-]+/)[0];\n\tlet url = java.getString('$..'+id+'..images.original',rr);\n\tif (url=='null') url = java.getString('$..'+id+'..images.medium',rr);\n\tlet re = new RegExp('\\\\[pixivimage\\\\:'+id+'\\\\]');\n\ttt = tt.replace(re,'<img src=\"'+gethdi(url)+'\"/>');\n\t}\ntt.replaceAll('[newpage]','\\nâ€”æ¢é¡µç¬¦â€”\\n').replace(/\\[\\[jumpuri\\:(.+)\\>.+\\]\\]/,'ğŸ–‡ï¸$1ğŸ–‡ï¸')\n</js>"
  },
  "ruleExplore": {
    "author": "@js:\nlet uid = java.getString('$.user.id');\njava.put('uid',uid);\njava.getString('$.user.name');",
    "bookList": "<js>\nif (baseUrl.startsWith('http://127.0') ) {\n\trr = [{}];\n\t} else {\nlet nurl = java.getString('$.next_url');\nif (nurl == '') {\n\tjava.toast('å‘ç°é¡µåˆ°åº•äº†');\n\tsource.put('nurl','http://127.0.0.1');\n\t}\nelse {\n\tsource.put('nurl',nurl);\n\t}\nif (baseUrl.includes('/watchlist/novel') ) {\n\trr = java.getElement(\"$.series\");\n\t} else { rr = java.getElement(\"$.novels\");}\n\n}\nrr\n</js>",
    "bookUrl": "<js>\nlet id = java.getString('$.id');\nlet sid = java.getString('$.series.id');\nlet rr = 'https://app-api.pixiv.net/webview/v2/novel?id=' + id;\n\nif (baseUrl.includes('/watchlist/novel') ) {\n\tsid = id;\n\tif (source.get('gc')=='1') book.name='ğŸ“˜'+book.name;\n}\nelse if (sid=='') {sid='ğŸ‡¨ğŸ‡³';}\nelse {\n\tlet jj = java.get('jianjie');\n\tjava.put('jianjie',book.name+'\\n'+jj);\n}\njava.put('sid',sid);\n`data:;base64,${java.base64Encode(rr)},{\"type\":\"px\"}`\n</js>",
    "coverUrl": "<js>\nif (baseUrl.includes('/watchlist/novel') ) {url = java.getString('$.url');}\nelse {url = java.getString('$.image_urls.large');}\ngethdi(url);\n</js>",
    "intro": "<js>\nlet jj = java.get('jianjie');\nlet rr = '\\n' + java.getString('$.caption');\nlet rs = java.htmlFormat(rr);\njava.put('jianjie',rs);\njj + rs\n</js>",
    "kind": "@js:\nif (baseUrl.includes('/watchlist/novel') ) {\n\trrr = '';\n\tjava.put('tags','');\n\ttm = java.getString('$.last_published_content_datetime');\n\t} else {\n\t\tlet tags=java.get('tags');\n\t\trr=String(tags).slice(1,-1).split(', ');\n\t\trrr = rr.filter(i => biaoq.test(i) );\n\t\trr.forEach(x=>{\n\t\t\tif (x=='èè‰') {\n\t\t\t\tif (!rrr.includes('å¹¼å¥³')) rrr.unshift(x);}\n\t\t\telse if (['ç†Ÿå¥³','æ·«å¦»'].includes(x)) {\n\t\t\t\tif (!rrr.includes('äººå¦»')) rrr.unshift(x);}\n\t\t\telse if (['ä»™ä¾ ','å¤é£','æ­¦ä¾ '].includes(x) && !rrr.some(y=>/[ä¿®ä»™å¤é£æ­¦ä¾ ]{2}/.test(y))) {\n\t\t\t\t\trrr.unshift(x);}\n\t});\n\t\ttm = java.getString('$.create_date');\n}\nlet d=new Date(tm);\nd=java.timeFormatUTC(d,'yy/MM/dd',8*60*60*1000);\n\nrrr.toString()+','+d",
    "name": "@js:\nresult = String(java.getString('$.title'));\nlet bookn = String(java.getString('$.series.title')).replace(/^ã€Š(.+)ã€‹$/,'$1');\nif (bookn != '') {\n\tjava.put('jianjie', 'ã€Š'+bookn+'ã€‹\\n');\n\tresult = result.replace(bookn,'â™¸').replace(/[ã€Šã€]?â™¸[ã€‘ã€‹]?/,'')||result;\n\t}\nresult = result.replace(/[(ï¼ˆ].{0,9}((?:ä»™ä¾ |çº¯çˆ±|åå®«|èè‰).?){3,}.{0,9}[)ï¼‰](?=\\s*[ä¸€-ê€€])/,'').replace(/ã€Š(.+)ã€‹/,'$1');\n\nlet tags = java.getStringList('$.tags..name');\njava.put('tags',tags);\ntags=String(tags).slice(1,-1).split(/, |\\//);\nlet bptag=source.getLoginInfoMap()['å±è”½æ ‡ç­¾']||'';\nif (bptag!='') {\n\tbptag = String(bptag).split(/[,\\|]/).map(x=>x.replace('#',''))\nfor (let char of tags)\nif (bptag.includes(char)) result=''\n}\nresult",
    "wordCount": "$.text_length"
  },
  "ruleSearch": {
    "author": "<js>\n{{(source.ruleExplore.author).replace('@js:','')}}\n</js>",
    "bookList": "<js>\npage=cache.getFromMemory('pxpage');\ncache.deleteMemory('pxpage');\nif (baseUrl.startsWith('http://127.')) {rr = [{}];}\n\nelse {\nrr = java.getElement('$.novels');\nnurl = java.getString('$.next_url');\nif (rr.length<6&&page==1&&nurl!='') {\n\t//å¤„ç†ä¸è§¦å‘ä¸‹ä¸€é¡µä¸”æœ‰nurlçš„æƒ…å†µ\n\tsleep(500);\n\trs = java.ajax(gethd(nurl));\n\tjava.setContent(rs)\n\trrr = java.getElement('$.novels');\n\t//åˆå¹¶å¯¹è±¡å‡½æ•°ï¼Œå¯ç›´æ¥ç”¨\n\trr.addAll(rrr);\n\tnurl = java.getString('$.next_url');\n}\n\nif (nurl == '') {\n\tjava.toast('æœç´¢é¡µåˆ°åº•äº†');\n\tsource.put('nurls','http://127.0.0.1');\n\t} else {source.put('nurls',nurl);}\n\n}\nrr\n</js>",
    "bookUrl": "<js>\nlet id = java.getString('$.id');\nlet sid = java.getString('$.series.id');\nif (sid=='') {\n\tsid='ğŸ‡¨ğŸ‡³';\n\t} else {\n\tlet jj = java.get('jianjie');\n\tjava.put('jianjie',book.name+'\\n'+jj);\n\t}\nlet rr = 'https://app-api.pixiv.net/webview/v2/novel?id=' + id;\njava.put('sid',sid);\n`data:;base64,${java.base64Encode(rr)},{\"type\":\"px\"}`\n</js>",
    "coverUrl": "$.image_urls.large\n<js>\ngethdi(result);\n</js>",
    "intro": "<js>\nlet jj = java.get('jianjie');\nlet rr = '\\n' + java.getString('$.caption');\nlet rs = java.htmlFormat(rr);\njava.put('jianjie',rs);\njj + rs\n</js>",
    "kind": "<js>\n{{(source.ruleExplore.kind).replace('@js:','')}}\n</js>",
    "name": "<js>\n{{(source.ruleExplore.name).replace('@js:','')}}\n</js>",
    "wordCount": "$.text_length"
  },
  "ruleToc": {
    "chapterList": "<js>\nlet sid = java.get('sid');\nif (sid == 'ğŸ‡¨ğŸ‡³') {result=[result];}\nelse {\n\ttry {\n\t\tlet url = java.hexDecodeToString(result);\n\t\t//ä¸‹ä¸€é¡µä¼šæŠ¥é”™ï¼Œç›´æ¥è·³è¿‡\nlet bookr=java.get('bookr')+'';\nif (!bookr) {\n\tlet rs=java.connect(gethd(url));\n\tif (rs.code() == 400) {\n\t\tsource.login();\n\t\tsleep(500);\n\t\trs=java.connect(gethd(url));}\nbookr=rs.body();}\n\t\tjava.setContent(bookr);\n\t\tjava.put('bookr',''); //ä¿è¯å•ç›®å½•æ—¶è¿›è¡Œåˆ·æ–°\n\t\t} catch(e){}\nresult = java.getElement('$.novels');\n}\nresult\n</js>",
    "chapterName": "<js>\nlet sid = java.get('sid');\nif (sid == 'ğŸ‡¨ğŸ‡³') {cc=book.name;}\nelse {\nlet title = java.getString('$.title');\ntitle = String(title).replace(/[(ï¼ˆ].{0,9}((?:ä»™ä¾ |çº¯çˆ±|åå®«|èè‰).?){3,}.{0,9}[)ï¼‰](?=\\s*[ä¸€-ê€€])/,'');\nlet bkn=String(book.name).replace(/^ğŸ“˜|[ã€‚ï¼Ÿï¼]+$/g,'');\n//æ¶ˆé™¤åä¸å‰©å­—åˆ™ä¸æ¶ˆé™¤\ncc = title.replace(bkn,'â™¸').replace(/[ã€Šã€]â™¸[ã€‚ï¼Ÿï¼]*[ã€‘ã€‹]\\s*|â™¸[ã€‚ï¼Ÿï¼\\s]*/,'')||title;\n\t}\nif (source.get('xh')==1) {\n\tcc='â–«ï¸'+cc;\n}\n\tcc\n</js>",
    "chapterUrl": "<js>\nlet sid = java.get('sid');\nif (sid == 'ğŸ‡¨ğŸ‡³') {\n\t\tuu=java.hexDecodeToString(result);\n\t\tbook.putCustomVariable('è¿™æ˜¯å•è´´ï¼Œé“¾æ¥ï¼š'+uu);\n\t}\nelse {\nlet id = java.getString('$.id');\nuu='https://app-api.pixiv.net/webview/v2/novel?id=' + id;\n}\ngethd(uu);\n</js>",
    "formatJs": "title.replace(/^â–«ï¸(?![ç¬¬åº]|#?ç¬¬?[\\dé›¶ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹åç™¾åƒ]+[ç« å›])/,'ç¬¬'+index+'ç«  ').replace(/^â–«ï¸/,'');",
    "nextTocUrl": "$.next_url\n<js>\nif (result!='[]') {\nresult=gethd(result[0]);\n}else{result=[];}\nresult\n</js>",
    "updateTime": "$.create_date\n<js>\nif (result) {\nlet d=new Date(result);\nupt=java.timeFormatUTC(d,\"yyyy/MM/dd HH:mm\",8*60*60*1000);\n}\nelse '';\n</js>"
  },
  "searchUrl": "<js>\nif (page == 1) {\ncache.putMemory('pxpage',page);\n\t\tif (/^\\u200b/.test(key)) {\n\t\t\tlet uid = cache.getFromMemory('pxuid');\n\t\t\tif (uid=='') java.longToast('\\nè¯·åˆ·æ–°ä¹¦ç±');\n\t\t\telse url = 'https://app-api.pixiv.net/v1/user/novels?filter=for_android&user_id=' + uid;}\n\t\telse if (key.startsWith('ä½œè€…@')) {\n\t\t\tlet uid = key.slice(3);\n\t\t\tif (!/^\\d{3,}$/.test(uid)) java.longToast('\\nè¯·è¾“å…¥æ­£ç¡®çš„id');\n\t\t\telse url = 'https://app-api.pixiv.net/v1/user/novels?filter=for_android&user_id='+uid;\t}\n\t\telse if (/\\d{5,}$/.test(key) ) {\n\t\t\tlet sid = key.match(/\\d+$/)[0];\n\t\t\tjava.put('sid',sid);\n\t\t\tif (key.startsWith('ä½œè€…')) java.longToast('\\nè¯·è¾“å…¥æ­£ç¡®çš„æœç´¢æ ¼å¼');\n\t\t\telse url = `data:;base64,${java.base64Encode(sid)},{\"type\":\"\"}`;}\n\t\telse if (key.startsWith('æ­£æ–‡@')) {\n\t\t\turl = 'https://app-api.pixiv.net/v1/search/novel?filter=for_android&merge_plain_keyword_results=true&sort=date_desc&search_target=text&word='+key.slice(3);}\n\t\telse { url = 'https://app-api.pixiv.net/v1/search/novel?filter=for_android&merge_plain_keyword_results=true&word='+key;}\nsource.put('nurls','http://127.0.0.1'); //é‡ç½®å‚¨å­˜çš„ä¸‹ä¸€é¡µ\n\n} else {url = source.get('nurls');}\ngethd(url)\n</js>",
  "weight": 0
}]