[{
  "articleStyle": 3,
  "contentBlacklist": ".*(?:pemsrv.com|mmfree3.com|magsrv.com).*,.*adcg.*gif",
  "customOrder": -10100157,
  "enableJs": true,
  "enabled": true,
  "enabledCookieJar": true,
  "header": "@js:\n(()=>{\n\tlet info=cache.getFromMemory('av18info');\nif (info) source.putLoginInfo(info),cache.deleteMemory('av18info');\nlet headerss=gethd();\nheaderss['User-Agent']=java.getWebViewUA();\n return JSON.stringify(headerss);\n})();",
  "jsLib": "banben=\"1.1.3\";\nsleep=Packages.java.lang.Thread.sleep;\nu_a = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 Edg/135.0.0.0';\nx_r_w = ''; //com.microsoft.emmx\ns_c_u_p = `\"Windows\"`;\ns_c_u = `\"Microsoft Edge\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"`;\na_l = 'zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7';\n\nfunction gethd(url='',ck='') {\n\tlet ck0 = this.source.getLoginHeader()||'';\n\tlet headerss = {\n\t\t  \t'User-Agent': u_a,\n\t\t  \t'Cookie': ck0,\n\t\t  \t'x-requested-with': x_r_w,\n     \t'Accept-Language': a_l\n    \t }\nif (ck==1&&url!='') return url+','+JSON.stringify({'headers':headerss,'webView':true});\nif (ck!='') headerss['Cookie']=ck;\nif (url=='') return headerss;\nreturn url+','+JSON.stringify({'headers':headerss});\n}\n\nfunction gets(x, r) {\nreturn r == undefined ? String(this.java.getString(x)) : String(this.java.getString(x,r));}\n\nfunction surl() {\n\tlet surl=this.source.getLoginInfoMap()['网址']+'';\n\tif (!surl||surl=='undefined') surl='https://mjv006.com';\n\treturn surl.replace(/\\/$/,'');}\n\nfunction tmtz() {\n\t\tlet tmt = this.source.getLoginInfoMap()['双击跳转时间']+[];\n\t\tif (tmt>2) return tmt;\n\t\telse return '10';\n\t}\n\nfunction tkey() {\n\tlet tkey = this.source.getLoginInfoMap()['每日更新日期']+[];\n\tif (tkey&&tkey!='undefined') {\n\t\ttkey = tkey.replace(/^\\d{0,2}(\\d{2})\\D(\\d{1,2})\\D(\\d{1,2})$/, (mt, p1, p2, p3)=>{\n\t\t\tp1='20'+p1;\n\t\t\tp2=p2.padStart(2, '0');\n\t\t\tp3=p3.padStart(2, '0');\n\t\t\tp2>12&&(p2='012')\n\t\t\tp3>31&&(p3='031')\n\t\t\treturn p1+'-'+p2+'-'+p3;\n\t\t\t});\n\t\t\tif (!/^\\d{4}-\\d{2}-\\d{2}$/.test(tkey)) {\n\t\t\t\ttkey='';\n\t\t\t\tthis.java.toast('\\n❎请输入正确的时间格式');}\n}\nif (!tkey||tkey=='undefined') {tkey = this.java.timeFormatUTC(Date.now(),\"yyyy-MM-dd\",6*60*60*1000)+[];}\n\treturn tkey;}\n\t\nfunction rrcheck(url, webr) {\n\tconst {java, source, cookie} = this;\n\tlet webr2 = org.jsoup.Jsoup.parse(webr);\n\tlet url19 = (webr2.select('#fwin_dialog_submit').attr('onclick')+'').match(/http[^\"']+/);\nif (url19) {\n\tlet ck=java.connect(url19)\n\t.headers()\n\t.values(\"Set-Cookie\");\n\tlet cks = [];\n\tfor (let char of ck) {\n\tchar=(char+'').replace(/;.+/,'');\n\tcks.push(char);}\n\tck=cks.join('; '); //带ajax得到的会话ck访问时不会有ck返回，为激活ck(主要用于不启用jar)\nck=ck||cookie.getCookie(url)+'';\n//勾选ckjar就能getck读取本次软件会话ck(重启软件失效)，setck函数才会一直保存源ck\nif (ck=='')\nck=source.getLoginHeader(); //获取现有ck\nelse\nsource.putLoginHeader(ck); //保存新ck\ncookie.setWebCookie(url,ck); //同步ck到内置浏览器\n\tsleep(120); //服务器记录可能需要延时\n\twebr=java.ajax(url); //访问前会执行一次请求头规则\n\t}\n\treturn java.t2s(webr)+'';\n}\n\n\nfunction gengxin(){\nconst {java, source} = this;\n\tlet url0='https://gitee.com/lyc486/yuedu2/commits/main/订阅/18AV/18av_特供版.json?browser_history=0&page=1&per=3';\n\tlet rr0=java.get(url0,{'User-Agent': 'Mozilla/5.0 (Linux; Android 14)','X-Requested-With': 'XMLHttpRequest'}).body();\n\tlet \tgxlrr = com.jayway.jsonpath.JsonPath.read(rr0, '$.list[0:3].title');\n\tlet [gxlr, gxlr2, gxlr3] = gxlrr;\n\tlet banben =   String(source.sortUrl).match(/let banben=\"([\\d\\.]+)\"/)[1];\n\tgxlr=String(gxlr).split(/^([^\\-]+)-/);\n\tgxlr[0]=='' ? '' : gxlr=['','0',gxlr[0]];\n\tlet gxts;\n\tif (gxlr[1]>banben){gxts=['更新','0,140,186'];}\n\telse {gxts= ['导入','76,175,80'];};\n\tlet htm = `<html><head>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>18AV ${gxts[0]}</title>\n<style>\ntable {\n\ttext-align: center;\n\tmargin: 0 auto;\n\t}\n.ann {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\theight: 50vh;\n\t}\nbutton {\n\tbackground-color: rgb(${gxts[1]});\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 4px;\n\theight: 6vh;\n\twidth: 30vw;\n\toverflow: hidden;\n\t}\nbutton span {\n  cursor: pointer;\n  display: inline-block;\n  position: relative;\n  transition: 0.4s;\n}\nbutton span:after {\n  content: '>';\n  position: absolute;\n  opacity: 0;\n  top: 0;\n  right: 30px;\n  transition: 0.2s;\n}\nbutton:active span {\n  padding-right: 20px;\n}\nbutton:active span:after {\n  opacity: 1;\n  right: -40px;\n}\n</style></head>\n<body>\n<table border=\"1\" cellspacing=\"0\">\n<th colspan=\"2\">最新日志：${gxlr[2]}</th>\n<tr><td>仓库版本：${gxlr[1]}</td>\n<td>本地版本：${banben}</td></tr>\n<tr>\n<td colspan=\"2\" style=\"text-align: left;\">往期日志：${gxlr2}<br>　　　　　${gxlr3}</td>\n</tr>\n</table>\n<div class=\"ann\">\n<a href=\"legado://import/importonline?src=https://gitee.com/lyc486/yuedu2/raw/main/订阅/18AV/18av_特供版.json\"><button><span>${gxts[0]}</span></button></a>\n</div>\n<a href=\"legado://import/importonline?src=https://cdn.jsdelivr.net/gh/Luoyacheng/yuedu@main/订阅/18AV/18av_特供版.json\" style=\"font-size: 10px;\">备用链接</a>\n</body>\n</html>`;\njava.startBrowser(`data:text/html;base64,${java.base64Encode(htm)}`,'订阅源更新');\r\n}\n\ntoastjs=`const toastStyle = document.createElement('style');\ntoastStyle.textContent = \".toast-container {position: fixed; z-index: 1000; pointer-events: none; display: flex; flex-direction: column; align-items: center;} .toast-container.top-center { top: 20px; left: 50%; transform: translateX(-50%); } .toast-container.top-left { top: 20px; left: 20px; } .toast-container.top-right { top: 20px; right: 20px; } .toast-container.bottom-center { bottom: 20px; left: 50%; transform: translateX(-50%); } .toast-container.bottom-left { bottom: 20px; left: 20px; } .toast-container.bottom-right { bottom: 20px; right: 20px; } .toast {background: rgba(0, 0, 0, 0.8); color: white; padding: 12px 14px; border-radius: 4px; margin-bottom: 10px;  word-break: initial; max-width: 80vw; opacity: 0; transform: translateY(20px); transition: opacity 0.3s, transform 0.3s; pointer-events: none;} .toast.show {opacity: 1; transform: translateY(0);} .toast.success {background: rgba(46, 204, 113, 0.9);} .toast.error {background: rgba(231, 76, 60, 0.9);} .toast.warning {background: rgba(241, 196, 15, 0.9);} .toast.info {background: rgba(52, 152, 219, 0.9);}\";\ndocument.head.appendChild(toastStyle);\nfunction showToast(message, duration = 3000, type = 'default', position = 'bottom-center') {\n  let container = document.querySelector('.toast-container');\n  if (!container) {\n    container = document.createElement('div');\n    container.className = 'toast-container';\n    document.body.appendChild(container);\n  }\n  container.className = \"toast-container \" + position;\n  const toast = document.createElement('div');\n  toast.className = \"toast \" + type;\n  toast.innerHTML = message;\n  container.appendChild(toast);\n  setTimeout(() => {\n    toast.classList.add('show');\n  }, 10);\n  setTimeout(() => {\n    toast.classList.remove('show');\n    setTimeout(() => {\n      if (toast.parentNode) {\n        toast.parentNode.removeChild(toast);\n      }\n    }, 300);\n  }, duration);\n}`;",
  "lastUpdateTime": 1759708028772,
  "loadWithBaseUrl": true,
  "loginUi": "@js:\n`[\n    {\n        name: \"网址\",\n        type: \"text\"\n    },\n    {\n        name: \"每日更新日期\",\n        type: \"text\"\n    },\n    \t{\n        name: \"ArtPlayer V${java.importScript('https://unpkg.com/artplayer/dist/artplayer.js').match(/artplayer.js.*v(.+)/i)[1]}\",\n        type: \"button\",\n        action: \"bfq()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": true\n        }\n    },\n    \t{\n        name: \"订阅源版本 \",\n        viewName:\"'订阅源版本 V'+banben\",\n        type: \"button\",\n        action: \"gengxin()\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"继续播放\",\n        type: \"toggle\",\n        chars:['⚪','⚫'],\n        default:\"⚪\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": true\n        }\n    },\n    \t{\n        name: \"自动播放\",\n        type: \"toggle\",\n        chars:['⚪','⚫'],\n        default:\"⚫\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"滑动等级\",\n        type: \"toggle\",\n        chars: [\"1️⃣\",\"2️⃣\",\"3️⃣\",\"4️⃣\",\"5️⃣\",\"6️⃣\",\"7️⃣\"],\n        default:\"3️⃣\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"显示链接\",\n        type: \"toggle\",\n        chars:['⚪','⚫'],\n        default:\"⚪\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"预览截图\",\n        type: \"toggle\",\n        chars:['⚪','⚫'],\n        default:\"⚪\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    \t{\n        name: \"播放器\",\n        type: \"toggle\",\n        chars:['默认','内置','外置'],\n        default:\"默认\",\n        style: {\n            \"layout_flexGrow\": 1,\n            \"layout_flexBasisPercent\": 0.4,\n            \"layout_wrapBefore\": flase\n        }\n    },\n    {\n        name: \"双击跳转时间\",\n        type: \"text\",\n        default: \"10\"\n    },\n    {\n        name: \"自定义分类\",\n        type: \"text\"\n    },\n    \t{\n        name: \"🌐网址发布\",\n        type: \"button\",\n        action: \"fabuye()\",\n        style: {\n            \"layout_flexGrow\": 0,\n            \"layout_flexBasisPercent\": -1,\n            \"layout_wrapBefore\": true\n        }\n    }\n]`",
  "loginUrl": "function login() {}\n\nfunction fabuye(){\n\tlet fbyu = source.get('fbyu')+'';\n\tlet headers = JSON.parse(eval(source.header.replace('@js:','')+''));\n\ttry {java.head(fbyu,headers);}\n\tcatch(e) {fbyu='https://mm18vc.com';}\n\tlet webr = java.startBrowserAwait(fbyu,'发布页',false).body();\n\tlet rr = org.jsoup.Jsoup.parse(webr);\n\tfbyu = rr.select('.list:nth-of-type(3) a').attr('href')+'';\n\tsource.put('fbyu',fbyu);\n\tlet surl = (rr.select('.list:nth-of-type(6) a').attr('href')+'').replace('http://','https://');\n\ttry {java.head(surl,headers);\n\tjava.longToast('已记录最新网址\\n'+surl);\n\tlet Info=source.getLoginInfoMap()||{};\n\tInfo['网址'] = surl;\n\tInfo = JSON.stringify(Info);\n\tcache.putMemory('av18info',Info);\n\tsource.putLoginInfo(Info);\t\n} catch(e) {java.longToast('得到的网址\\n'+surl+'\\n无法访问，不进行记录');}\n}\n\nfunction bfq(){\njava.toast('\\n正在更新播放器...');\njava.deleteFile('dcc1a0ac99b90ead.js');\nlet [,bb]=java.cacheFile('https://unpkg.com/artplayer/dist/artplayer.js').match(/artplayer.js.*v(.+)/i);\njava.longToast('\\n当前版本号：V'+bb);\n\t}",
  "ruleArticles": "<js>\nlet url = java.hexDecodeToString(result)+'';\nurl=surl()+url.replace(/^http.{4}[^\\/]+/,'');\nlet webrh=cache.get(url)+'';\nif (webrh.length<6999) {\nwebrh=java.ajax(url);\nwebrh=rrcheck(url, webrh);\nlet webr = org.jsoup.Jsoup.parse(webrh);\nwebr = webr.select('.posts>.post');\nif (webr=='') {result=[];}\nelse {\n\tlet fmurl = webr.first().select(\"img\").attr(\"src\");\nif (fmurl=='') {result=[];}\nelse {\n\t//正确网络加载\n\tresult=webr;\n\tlet cfm=true;\nif (/animation_list\\/all|dt_list\\/all/.test(url)) {\ncache.put(url,webrh,3600*24*3);}\nelse if (/content_news\\/all/.test(url)) {\n\tlet fmurlmr = result.get(1)?.select(\"img\").attr(\"src\");\nsource.put('fmurlmr',fmurlmr);\ncache.put(url,webrh,3600*24*2);}\nelse if (/fc_search\\/all/.test(url)) {\ncache.put(url,webrh,3600*24*2);}\nelse if (/uncensored_list\\/all|chinese_list\\/all/.test(url)) {\ncache.put(url,webrh,3600*24);}\nelse {\n\tif (!url.includes(\"_random\")) {\n\tcfm=false;\n\tswitch (String(Date.now()).substr(-1)) {\n\tcase \"1\": source.put('fmsj1',fmurl);break;\n\tcase \"2\": source.put('fmsj2',fmurl);break;\n\tcase \"3\": source.put('fmsj3',fmurl);break;}\n\t}\ncache.put(url,webrh,3600*4);\n//其他分类\n}\n\nif (cfm) source.put('fm'+url,fmurl);\n//有封面\n}\n//有dom\n}\n//没缓存\n} else {\n\tlet mk=cache.getFromMemory(url+'2')||0;\n\tcache.putMemory(url+'2',mk+1);\n\tlet tmh = new Date().getHours();\n\tif (/content_news\\/all|animation_list\\/all|fc_search\\/all/.test(url)) {\n\t\tmk>3&&cache.delete(url);}\n\telse if (mk>1||tmh>1&&tmh<4) {\n\t\tcache.deleteMemory(url+'2');\n\t\tcache.delete(url);}\n\t\twebrh = org.jsoup.Jsoup.parse(webrh);\n\t\tresult = webrh.select('.posts>.post');\t\t\n}\nresult\n</js>",
  "ruleContent": "<js>\nlet uu = java.hexDecodeToString(result) + '';\nresult = uu.replace(/^https|[\\/\\.\\_\\-\\:\\s]|html$/g, '');\nlet ssurl = surl();\nlet url = ssurl + uu;\nif (uu.startsWith(\"http\")) url = uu;\nlet webr = cache.get(url) + '';\nif (webr.length < 6999) {\n    webr = java.ajax(url);\n    webr = rrcheck(url, webr);\n    cache.put(url, webr, 3600 * 24 * 20);\n}\nlet title = gets('h1.0@text', webr);\nlet pimg = gets('#player-wrap img@src', webr);\nlet yimgs = gets('.ut1_img_content_smallcg@html', webr).replaceAll('https://fchost', 'http://cdn.cdnjson.com/pic.html?url=fchost');\nlet jianjie = gets('.posts-inner-details-text,.actor-right-details-images,.posts-inner-details-text@html', webr).replaceAll('https://pics.', 'http://cdn.cdnjson.com/pic.html?url=pics.');\nlet posts = org.jsoup.Jsoup.parse(webr).select('.video .posts');\nposts.select('video').remove();\n\n//获取配置\nvar info = source.getLoginInfoMap();\n\nresult = `\n  <!DOCTYPE html>\n  <html lang=\"zh-CN\">\n  \n  <head>\n    <meta charset=\"UTF-8\">\n    <title>${rssArticle.sort}</title>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n    <style>\n      * {\n        margin: 0;\n        padding: 0;\n        box-sizing: border-box;\n      }\n      html,\n      body {\n        width: 100%;\n        overflow-x: hidden;\n        overflow-wrap: break-word;\n        word-break: break-all;\n      }\n      .artplayer-app {\n          position: relative;\n      \taspect-ratio: 16/9;\n      }\n      .play-indicator {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          font-size: 42px;\n          text-shadow: 0 0 10px rgba(0, 0, 0, 0.9);\n      }\n      .ut1_img_content_smallcg {\n        display: flex;\n        flex-wrap: wrap;\n        line-height: 0;\n        justify-content: space-between;\n      }\n      .img_smallcg img {\n        width: 50vw;\n        height: auto;\n      }\n      .posts-inner-details-text-top {\n        display: flex;\n        flex-wrap: wrap;\n      }\n      .posts-inner-details-text-left ul {\n        display: flex;\n        width: 50vw;\n        flex-wrap: wrap;\n      }\n      .posts-inner-details-text-left li {\n        width: 25vw;\n        list-style: none;\n        flex-wrap: wrap;\n      }\n      .posts-inner-details-text-under li span {\n        margin-right: 1ex;\n      }\n      h3 {\n        margin: 1ex;\n      }\n      .posts {\n      \tmax-height: 0;\n      \toverflow: hidden;\n      \t}\n      \t.posts.active {\n      \tmax-height: max-content;\n      \t}\n    </style>\n  </head>\n  \n  <body>\n    <div class=\"artplayer-app\">\n${info['播放器'] == '默认'?'':'<img src=\"'+pimg+'\" width=\"100%\">'}\n</div>\n    <div class=\"jianjie\">\n    <h3>${title}</h3>\n    ${info['预览截图']=='⚪'?yimgs:''}\n    ${jianjie}\n    <div id=\"pyurl\"></div>\n    <br>\n    </div>\n    <h2 onclick=\"sjzt()\" style=\"text-align: center;\">▼随机主题▼</h2>\n    ${posts}\n    <br>\n    <br>\n    <script>\n    ${toastjs}\n    </script>\n    <script>\nconst posts=document.querySelector('.posts');\nfunction sjzt() {\n\tposts.classList.toggle('active');\n\t}\nconst mrp=${info['播放器'] == '默认'};\nconst jjm=\\`\nlet srcurl = source.get(\"av18${result}\") + '';\nif (!srcurl) {\n    let webjs = \"jfun_show_vfc();$('body .main .container_small center').html()\";\n  try {\n    webr = java.webView(cache.get(\"${url}\"), \"${url}\", webjs);\n  } catch(err) {webr='';}\n    srcurl = webr.match(/\\\\\\\\/\\\\\\\\/[^\"']+js\\\\\\\\/player\\\\\\\\/[^\"']+php\\\\\\\\?id=100_([^\"'_]+)_([^\"']+)/);\n    if (srcurl) {\n        srcurl = \"/\"+srcurl[1]+\"/\"+srcurl[2]+\"/\"+srcurl[2]+\".m3u8\";\n        source.put(\"av18${result}\", srcurl);\n    }\n  }\nif (!srcurl) {\ncache.delete(\"${url}\");\njava.longToast('💔未获取到播放链接');}\nelse if (/18av\\\\.mm\\\\-/.test(\"${ssurl}\"))\n\tsrcurl = \"https://v.imgstream2.com\"+ srcurl;\nelse\n\tsrcurl = \"${ssurl}\".replace('//', '//fc.') + srcurl;\nsrcurl\\`;\n\nfunction setting() {\n\tlet art = new Artplayer({\n        container: '.artplayer-app',\n        poster: '${pimg}',\n        id: '${result}',\n        theme: '#ffad00',\n        autoplay: ${info['自动播放']=='⚪'},\n        muted: false,\n        fullscreen: true,\n        autoSize: true,\n        autoMini: false,\n        playbackRate: true,\n        setting: true,\n        lock: true,\n        gesture: true,\n        fastForward: true,\n        autoPlayback: ${info['继续播放']=='⚪'},\n        autoOrientation: true,\n      });\n    Artplayer.PLAYBACK_RATE = [0.75, 1, 2, 4, 6];\n    Artplayer.FAST_FORWARD_TIME = 500;\n    Artplayer.MOBILE_DBCLICK_PLAY = false;\n    Artplayer.TOUCH_MOVE_RATIO = 0.${String(info[\"滑动等级\"])[0]};\n art.on('dblclick', (event) => {\n\t const tmz = +\"${tmtz()}\";\n\t\tconst clix = event.clientX;\n\t\tconst rwid = art.rect.width;\n\t if (clix < rwid / 3) art.backward = tmz;\n\t else if (clix > rwid * 2 / 3) art.forward = tmz;\n\t else art.toggle();\n});\nart.once('ready', () => {\nlet lo=localStorage.getItem(\"artplayer_settings\")+'';\nif (lo.length<9)\nwindow.run(\"source.get('localS')\").then(r=>localStorage.setItem(\"artplayer_settings\",r));\nelse\nwindow.run(\"source.put('localS',\\`\"+lo+\"\\`)\")\n \n});\nreturn art;\n}\nasync function init () {\nconst startTime = Date.now();\nawait new Promise((resolve, reject) => {\n  const checkRun = () => {\n    if (typeof window.run === 'function') resolve();\n    else if (Date.now() - startTime >= 3000) reject(new Error('初始化错误'));\n    else setTimeout(checkRun, 50);\n   };\n   checkRun();\n});\n\nconst r = await window.run(\"java.importScript('https://unpkg.com/artplayer/dist/artplayer.js')\");\neval(r);\nvar art;\nif (mrp) art = setting();\nconst u = await window.run(jjm);\nif (mrp) art.url = u;\nif (${info['显示链接']=='⚪'})\ndocument.getElementById(\"pyurl\").innerHTML=\\`<p>播放链接：<span>\\${u}</span><button onclick=\"copyText(this,'before')\" style=\"margin-left: 2ex;\">⎘复制</button></p>\\`;\nif (${info['播放器'] == '外置'}) window.run(\"java.openUrl('\"+u+\"','video/*')\");\nelse if(${info['播放器'] == '内置'}) {\n    const pp = () => {\n    window.run(\"java.openVideoPlayer('\"+u+\"',\"+\n\\`'${title.replace(/'/g,\"\\\\'\")}'\\`+\",true)\");\n};\n    if (${info['自动播放']=='⚪'})\n    pp();\n    else {\n        const pyv=document.querySelector('.artplayer-app');\n        const ttis = document.createElement('div');\n        ttis.className = 'play-indicator';\n        ttis.textContent = '▶️';\n        pyv.appendChild(ttis);\n        pyv.addEventListener('click', () => {\n            pp();\n        });\n    }\n}\n//console.log(document.documentElement.outerHTML)\n\t}\nsetTimeout(init, 50);\n</script>\n<script>\nfunction copyText(button, weizi) {\nconst text = weizi == 'before' ?\nbutton.previousElementSibling.textContent :\nweizi == 'after' ? button.nextElementSibling.textContent :\n'异常';\n    const btext = button.textContent;\n    navigator.clipboard.writeText(text)\n        .then(() => {\n            button.textContent = \"✓已复制\";\n            setTimeout(() => {\n                button.textContent = btext;\n            }, 1500);\n        })\n        .catch(err => {\n            button.textContent = \"✗失败\";\n            setTimeout(() => {\n                button.textContent = btext;\n            }, 1500);\n        });\n}\n\nvar pressTimer = null;\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\ndocument.querySelector('.jianjie').addEventListener('touchstart', (e) => {\n\tlet ee=e.target;\n\tif (ee.tagName=='A')\n\tpressTimer = setTimeout(() => {\n\t\tlet txt=ee.textContent+\"::\"+ee.href;\nnavigator.clipboard.writeText(txt).then(()=>{\n\tshowToast(\"已复制到剪贴板，可填入登录界面自定义分类。<br>\"+txt, 1600);\n\t});\n}, 1200);\n});\n  \ndocument.querySelector('.jianjie').addEventListener('touchend', e => {\n\tif (pressTimer) {\n\t\tclearTimeout(pressTimer);\n\t\tpressTimer = null;}\n});\n\ndocument.querySelector('.jianjie').addEventListener('click', e => {\n\tlet ee=event.target.closest('a');\n\tif (ee) {\n\t\te.preventDefault();\n\t\tlet url=ee.href;\n\t\tlet tt=ee.textContent;\n\t\tif (!tt) {\n\t\t\tlet a=ee.nextElementSibling.querySelector('a');\n\t\t\tif (a) tt=a.textContent;\n\t\t\t}\n\t\twindow.openui(\"sort\",{[tt]:\\`data:;base64,\\{\\{java.base64Encode(\"\\${url.replace(/[^\\\\\\\\/].html/,'')}\"+page+\".html\")\\}\\},{\"type\":\"18av\"}\\`});\n\t\t}\n});\n\ndocument.querySelector('.posts').addEventListener('click', e => {\n\tlet ee=event.target.closest('a');\n\tif (ee) {\n\t\te.preventDefault();\n\t\tlet tt=ee.innerText;\n\t\tif (!tt) {\n\t\t\tlet h3=ee.parentElement.nextElementSibling.querySelector('h3');\n\t\t\tif (h3) tt=h3.textContent;\n\t\t\t}\nwindow.openui(\"rss\",{[tt]:\\`\\${ee.href}@js:'data:;base64,\\${btoa(ee.href.replace(/^http.{4}[^\\/]+/,''))},{\"type\":\"18av\"}'\\`});\n\t\t}\n});\n\n});\n</script>\n  </body>\n  </html>\n  `;\n</js>",
  "ruleImage": "img@src",
  "ruleLink": "a.0@href\n<js>\nlet url=java.base64Encode(result.replace(/^http.{4}[^\\/]+/,''));\nresult+`@js:'data:;base64,${url},{\"type\":\"18av\"}'`;\n</js>",
  "ruleNextPage": "page",
  "rulePubDate": ".con .meta@text",
  "ruleTitle": ".con a@text",
  "shouldOverrideUrlLoading": "if (url.includes(\"/chinese_category/\")) {\n\tjava.open(\"sort\",`data:;base64,{{java.base64Encode(\"${url.replace(/[^\\\\/].html/,'')}\"+page+\".html\")}},{\"type\":\"18av\"}`);\n\ttrue\n}\nelse false",
  "showWebLog": false,
  "singleUrl": false,
  "sortUrl": "@js:\nlet fkey = (source.getLoginInfoMap()['自定义分类'] || '') + '';\nfkey = fkey.trim().split(/\\s+/).map(x => x\n    .replace(/::https.{3}[^\\/]+/, '::data:;base64,{{java.base64Encode(\"')\n    .replace(/(?:\\d+|page)\\.html$/, '\"+page+\".html\")')\n    .replace(/(?:index)\\.html$/, 'index.html?t=\"+page)') + '}},{\"type\":\"18av\"}').join('\\n');\n`中文字幕::data:;base64,{{java.base64Encode(\"/zh/chinese_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}\n搜索1::data:;base64,{{java.base64Encode(((y=skey(1).match(/\\\\/zh\\\\/.+(?=\\\\/1.html)/))?y[0]:(\"/zh/fc_search/all/\"+skey(1)))+\"/\"+page+\".html\")}},{\"type\":\"18av\"}\n每日更新::data:;base64,{{java.base64Encode(\"/zh/content_news/all/\"+tkey()+\".html\")}},{\"type\":\"18av\"}\n随机近作::data:;base64,{{java.base64Encode(\"/zh/chinese_random/all/index.html?t=\"+page)}},{\"type\":\"18av\"}\n随机所有::data:;base64,{{java.base64Encode(\"/zh/chinese_randomall/all/index.html?t=\"+page)}},{\"type\":\"18av\"}\n${fkey}`",
  "sourceGroup": "🙈",
  "sourceIcon": "https://gitee.com/lyc486/yuedu/raw/master/0GP0yD.gif",
  "sourceName": "18AV",
  "sourceUrl": "https://18av.luoyacheng.ip-ddns.com",
  "startHtml": "@js:\nlet su=surl();\nlet zm=source.get('fm'+su+\"/zh/chinese_list/all/1.html\")+'';\nlet wm=source.get('fm'+su+\"/zh/uncensored_list/all/1.html\")+'';\nlet sjd=source.get('fm'+su+\"/zh/chinese_random/all/index.html?t=1\")+'';\nlet sja=source.get('fm'+su+\"/zh/chinese_randomall/all/index.html?t=1\")+'';\nlet sjm=source.get('fm'+su+\"/zh/animation_random/all/index.html?t=1\")+'';\nlet gc=source.get('fm'+su+\"/zh/dt_list/all/1.html\")+'';\nlet dm=source.get('fm'+su+\"/zh/animation_list/all/1.html\")+'';\nlet mr=source.get('fmurlmr')+'';\nlet fmsj1=source.get('fmsj1')+'';\nlet fmsj2=source.get('fmsj2')+'';\n\n`<html>\r\n\r\n<head>\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=no\">\r\n    <title>18AV</title>\r\n</head>\r\n\r\n<body>\r\n    <div class=\"container\">\r\n        <form id=\"ss\">\r\n            <input type=\"text\" name=\"key\" id=\"searchkey\" placeholder=\"输入关键词\">\r\n            <button type=\"submit\">搜 索</button>\r\n        </form>\n        \n<div class=\"history-container\">\n <div class=\"history-header\">\n<div class=\"history-title\">搜索历史</div>\n<button id=\"clearHistory\">清除记录</button>\n</div>\n<div id=\"historyList\"></div>\n</div>\n        \r\n        <div id=\"fl\">\r\n            <div onclick=\"ff('中文字幕')\">${zm?`<img src=\"${zm}\" alt=\"暂无图片\">`:''}<span>中文字幕</span></div>\r\n            <div onclick=\"ff('高清无码')\">${wm?`<img src=\"${wm}\" alt=\"暂无图片\">`:''}<span>高清无码</span></div>\n            <div onclick=\"ff('动画动漫')\">${dm?`<img src=\"${dm}\" alt=\"动画动漫\">`:''}<span>动画动漫</span></div>\r\n            <div onclick=\"ff('随机近作')\">${sjd?`<img src=\"${sjd}\" alt=\"暂无图片\">`:''}<span>随机近作</span></div>\r\n            <div onclick=\"ff('随机所有')\">${sja?`<img src=\"${sja}\" alt=\"暂无图片\">`:''}<span>随机所有</span></div>\n            <div onclick=\"ff('随机动漫')\">${sjm?`<img src=\"${sjm}\" alt=\"暂无图片\">`:''}<span>随机动漫</span></div>\n            <div onclick=\"ff('每日更新')\">${mr?`<img src=\"${mr}\" alt=\"暂无图片\">`:''}<span>每日更新</span></div>\r\n            <div onclick=\"ff('国产自拍')\">${gc?`<img src=\"${gc}\" alt=\"暂无图片\">`:''}<span>国产自拍</span></div>\r\n            <div onclick=\"ff('自选分类')\">${fmsj2?`<img src=\"${fmsj2}\" alt=\"暂无图片\">`:''}<span>自选分类</span></div>\r\n            <div onclick=\"window.location.href='${su}/zh/chinese_categorylist/list/index.html'\">${fmsj1?`<img src=\"${fmsj1}\" alt=\"暂无图片\">`:''}<span>分类清单</span></div>\r\n        </div>\r\n        <div class=\"bottom-line\"></div>\r\n    </div>\r\n</body>\r\n\r\n</html>`",
  "startJs": "const HISTORY_KEY = 'searchHistory';\nconst MAX_HISTORY_ITEMS = 10;\n        const ss = document.getElementById('ss');\n        const historyList = document.getElementById('historyList');\n        const clearHistoryBtn = document.getElementById('clearHistory');\n        const searchInput = document.getElementById('searchkey');\n        function performSearch(keyword) {\n            if (!(keyword.length>1)) return;\n            addHistoryItem(keyword);\n            searchInput.value=\"\";\n            window.openui(\"sort\", { [keyword]: `data:;base64,{{java.base64Encode(\"/zh/fc_search/all\"+\"/${keyword}/\"+page+\".html\")}},{\"type\":\"18av\"}` });\n        }\n        \r\n        ss.addEventListener('submit', function (event) {\r\n            event.preventDefault();\r\n            const formData = new FormData(ss);\r\n            const key = formData.get('key');\r\n            if (key) {\n            \tperformSearch(key);\n           } else {\n           \tsearchInput.placeholder = \"输入关键词，亲\";\n           searchInput.focus();}\r\n        });\n//const tt = new Intl.DateTimeFormat('zh-CN', {year: 'numeric', month: '2-digit', day: '2-digit'}).format(new Date()).replace(/\\//g, '-');\nconst fl = {\n\t\"中文字幕\":`data:;base64,{{java.base64Encode(\"/zh/chinese_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\"高清无码\":`data:;base64,{{java.base64Encode(\"/zh/uncensored_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\t\"随机近作\":`data:;base64,{{java.base64Encode(\"/zh/chinese_random/all/index.html?t=\"+page)}},{\"type\":\"18av\"}`,\n\t\t\t\t\"随机所有\":`data:;base64,{{java.base64Encode(\"/zh/chinese_randomall/all/index.html?t=\"+page)}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"国产自拍\":`data:;base64,{{java.base64Encode(\"/zh/dt_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"每日更新\":`data:;base64,{{java.base64Encode(\"/zh/content_news/all/\"+tkey()+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"动画动漫\":`data:;base64,{{java.base64Encode(\"/zh/animation_list/all/\"+page+\".html\")}},{\"type\":\"18av\"}`,\n\t\t\t\t\t\"随机动漫\":`data:;base64,{{java.base64Encode(\"/zh/animation_random/all/index.html?t=\"+page)}},{\"type\":\"18av\"}`\n\t}\n        function ff(n) {\n        \tif (n=='自选分类') {\n        \t\t(async () => {\n        \t\t\tconst fkey = await window.run(\"source.getLoginInfoMap()['自定义分类']\");\n        \t\t\tlet obj = {};\n        \t\t\tif (fkey.length>9) {\n        \t\t\tfkey.trim().split(/\\s+/).forEach(x=> {\n        \t\t\tlet [y1,y2] = x.split('::');\n        \t\t\tobj[y1]=`data:;base64,{{java.base64Encode(\"${y2.replace(/\\d+\\.html$/,'\"+page+\".html\"')})}},{\"type\":\"18av\"}`});\n        \t\twindow.openui(\"sort\", obj);\n        \t\t} else alert(\"请在登录界面填写自定义分类\")\n})();\n        \t\treturn\n        \t\t}\n        \tlet url = fl[n];\n        \tif (url) window.openui(\"sort\", { [n]: url});\n        \t}\r\n\r\n        ss.style.animation = `fadeIn 0.6s ease-out forwards`;\r\n        document.querySelectorAll('#fl > div').forEach((child, index) => {\r\n            child.style.animation = `fadeIn ${0.8 + index * 0.3}s ease-out forwards`;\r\n        });\n        \nfunction loadHistory() {\n return JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];\n}\nfunction saveHistory(history) {\nlocalStorage.setItem(HISTORY_KEY, JSON.stringify(history));\n}\nfunction addHistoryItem(keyword) {\n            let history = loadHistory();\n            history = history.filter(item => item !== keyword);\n            history.unshift(keyword);\n            if (history.length > MAX_HISTORY_ITEMS) {\n                history = history.slice(0, MAX_HISTORY_ITEMS);\n            }\n            saveHistory(history);\n            renderHistory();\n        }\nfunction removeHistoryItem(keyword) {\n            let history = loadHistory();\n            history = history.filter(item => item !== keyword);\n            saveHistory(history);\n            renderHistory();\n        }\nfunction clearHistory() {\n            if (confirm('确定要清除所有搜索历史吗？')) {\n                localStorage.removeItem(HISTORY_KEY);\n                renderHistory();\n            }\n        }\n// 显示历史\n        function renderHistory() {\n            const history = loadHistory();\n            historyList.innerHTML = '';\n            if (history.length === 0) {\n                historyList.innerHTML = '<div class=\"no-history\">暂无搜索历史</div>';\n                return;\n            }\n            \n            history.forEach(keyword => {\n                const item = document.createElement('div');\n                item.className = 'history-item';\n                item.innerHTML = `${keyword}<span class=\"fa-times\" data-keyword=\"${keyword}\">🗑️</span>`;\n                historyList.appendChild(item);\n                \n                // 点击搜索\n                item.addEventListener('click', (e) => {\n                    if (!e.target.classList.contains('fa-times')) {\n                        searchInput.value = keyword;\n                        performSearch(keyword);\n                    }\n                });\n                \n                // 处理删除按钮\n                const deleteBtn = item.querySelector('.fa-times');\n                deleteBtn.addEventListener('click', (e) => {\n                    e.stopPropagation();\n                    removeHistoryItem(keyword);\n                });\n            });\n        }\n\nclearHistoryBtn.addEventListener('click',clearHistory);        \nrenderHistory();\n\n//console.log(document.documentElement.outerHTML);",
  "startStyle": "        * {\r\n            margin: 0;\r\n            padding: 0;\r\n            box-sizing: border-box;\r\n            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;\n            user-select: none;\r\n        }\r\n        ::-webkit-scrollbar {\r\n            display: none;\r\n        }\r\n        body {\r\n            display: flex;\r\n            justify-content: center;\r\n            min-height: 100vh;\r\n            background: linear-gradient(135deg, #617696 0%, #e4edf5 100%);\r\n            padding: 10px 20px 20px 20px;\r\n            color: #333;\r\n        }\r\n        .container {\r\n            width: 100%;\r\n            text-align: center;\r\n            background: rgba(255, 255, 255, 0.86);\r\n            border-radius: 24px;\r\n            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.08);\r\n            position: relative;\r\n            overflow-y: auto;\r\n        }\r\n        .container::before {\r\n            content: '';\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 28px;\r\n            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);\r\n        }\r\n        .bottom-line {\r\n            width: 100%;\r\n            height: 28px;\r\n            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);\r\n        }\r\n        #ss {\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            margin: 30px auto;\r\n            width: 100%;\r\n            position: relative;\r\n        }\r\n        #ss input[type=\"text\"] {\r\n            width: 60%;\r\n            padding: 0px 20px;\r\n            margin-right: 10px;\r\n            height: 60px;\r\n            font-size: 1.15rem;\r\n            border: 2px solid #e3eef9;\r\n            border-radius: 16px;\r\n            outline: none;\r\n            background: #ffffff;\r\n            color: #2c3e50;\r\n            box-shadow:\r\n                0 5px 20px rgba(0, 0, 0, 0.03),\r\n                inset 0 1px 3px rgba(0, 0, 0, 0.05);\r\n            transition: all 0.3s ease;\r\n        }\r\n        #ss input[type=\"text\"]::placeholder {\r\n            color: #b0c1d3;\r\n            font-weight: 400;\r\n        }\r\n        #ss input[type=\"text\"]:focus {\r\n            border-color: #4facfe;\r\n            box-shadow:\r\n                0 8px 25px rgba(79, 172, 254, 0.15),\r\n                inset 0 1px 3px rgba(0, 0, 0, 0.03);\r\n        }\r\n        #ss button {\r\n            position: relative;\r\n            width: 30%;\r\n            height: 40px;\r\n            padding: 0px;\r\n            font-size: 1.1rem;\r\n            font-weight: 600;\r\n            border: none;\r\n            border-radius: 12px;\r\n            background: linear-gradient(90deg, #3f8abc 0%, #177eae 100%);\r\n            color: white;\r\n            transition: all 0.3s ease;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n        }\r\n        #ss button:hover {\r\n            background: linear-gradient(90deg, #4290d4 0%, #1c98d2 100%);\r\n            transform: translateY(-2px);\r\n        }\r\n        #ss button:active {\r\n            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);\r\n            transform: translateY(1px);\r\n        }\r\n        #ss button i {\r\n            margin-right: 10px;\r\n            font-size: 1rem;\r\n        }\r\n        #fl {\r\n            display: flex;\r\n            flex-direction: column;\r\n            justify-content: center;\r\n            align-items: center;\r\n        }\r\n        #fl>div {\r\n            width: 300px;\r\n            aspect-ratio: 16/9;\r\n            overflow: hidden;\r\n            /* 约束图片高度 */\r\n            border: 2px dotted;\r\n            margin-bottom: 10px;\r\n            position: relative;\r\n        }\r\n        #fl>div>span {\r\n            display: block;\r\n            position: absolute;\r\n            top: 3%;\r\n            right: 3%;\r\n            font-weight: bold;\r\n            font-family: 'Impact', 'Arial Black', cursive, sans-serif;\n            font-size:0.5rem;\r\n            text-shadow: 2px 2px 6px #333, 0 0 20px #1c98d2;\r\n            background-color: rgba(191, 220, 245, 0.6);\r\n            border-radius: 20px;\r\n            padding: 5px 10px;\r\n        }\r\n        #fl>div>img {\r\n            width: 100%;\r\n            height: 100%;\r\n            display: block;\r\n            object-fit: cover;\r\n            object-position: center center;\r\n            filter: brightness(0.9);\r\n        }\r\n        @keyframes fadeIn {\r\n            from {\r\n                opacity: 0;\r\n                transform: translateY(20px);\r\n            }\r\n            to {\r\n                opacity: 1;\r\n                transform: translateY(0);\r\n            }\r\n        }\n\n.history-container {\n            width: 90%;\n            max-width: 700px;\n            margin: 0 auto 25px;\n            padding: 15px;\n            background: rgba(255, 255, 255, 0.95);\n            border-radius: 16px;\n            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);\n            text-align: left;\n            animation: fadeIn 0.5s ease-out forwards;\n        }\n        .history-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 12px;\n            padding-bottom: 10px;\n            border-bottom: 1px solid #eaeaea;\n        }\n        .history-title {\n            font-size: 1.2rem;\n            font-weight: 600;\n            color: #2c3e50;\n            display: flex;\n            align-items: center;\n        }\n        #clearHistory {\n            background: none;\n            border: none;\n            color: #888;\n            font-size: 0.9rem;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            transition: color 0.2s;\n        }\n        #clearHistory:hover {\n            color: #ff6b6b;\n        }\n        #historyList {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 10px;\n        }\n        .history-item {\n            background: rgba(79, 172, 254, 0.1);\n            border: 1px solid rgba(79, 172, 254, 0.3);\n            border-radius: 50px;\n            padding: 8px 10px 8px 16px;\n            font-size: 0.95rem;\n            transition: all 0.2s;\n            color: #3f8abc;\n            display: flex;\n            align-items: center;\n        }\n        .history-item:hover {\n            background: rgba(79, 172, 254, 0.2);\n            transform: translateY(-2px);\n            box-shadow: 0 3px 8px rgba(79, 172, 254, 0.2);\n        }\n.fa-times {\nmargin-left: 10px;\nfont-size: 10px;\nwidth: 10px;\n\t}"
}]